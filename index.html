<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>William Liu - Links</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="./style.css">
</head>

<body onload="changeColor();">
  <div id="vanta"></div>
  <main>
    <header>
      <img src="./images/WilliamLiu.JPG" />
      <h1>@william967948</h1>
    </header>
    <ul>
      <li id="facebook" class="facebook" onmouseover="hover(this.id);" onmouseout="unhover(this.id);"
        onclick="stopTextColor();">
        <a class="link" href="https://www.facebook.com/profile.php?id=100004865142685">
          <img id="img-facebook" src="./images/facebook-logo.gif" alt="facebook" width="20">
          Facebook
        </a>
      </li>
      <li id="github" class="github">
        <a class="link" href="https://github.com/william967945">
          <img id="img-github" src="./images/github-logo.gif" alt="GitHub" width="20">
          GitHub
        </a>
      </li>
      <li id="linkedin" class="linkedin" onmouseover="hover(this.id);" onmouseout="unhover(this.id);">
        <a class="link" href="https://www.linkedin.com/in/william967945">
          <img id="img-linkedin" src="./images/linkedin-logo.gif" alt="Linkedin" width="20">
          Linkedin
        </a>
      </li>
      <li id="instagram" class="instagram" onmouseover="hover(this.id);" onmouseout="unhover(this.id);">
        <a class="link" href="https://www.instagram.com/c.han_liu">
          <img id="img-instagram" src="./images/instagram-logo.gif" alt="Instagram" width="20">
          Instagram
        </a>
      </li>
      <li id="gmail" class="gmail" onmouseover="hover(this.id);" onmouseout="unhover(this.id);">
        <div class="tooltip">
          <span class="tooltiptext" id="myTooltip"></span>
          <button id="button-gmail" class="button" onclick="myFunction();" onmouseout="outFunc();">
            <img id="img-gmail" src="./images/gmail-logo.gif" alt="Gmail" width="20">
            william967948@gmail.com
          </button>
        </div>
      </li>
    </ul>
  </main>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js"></script>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      VANTA.WAVES({
        el: "#vanta",
        mouseControls: true,
        touchControls: true,
        gyroControls: false,
        minHeight: 614.00,
        minWidth: 200.00,
        scale: 1.00,
        scaleMobile: 1.00,
        color: 0x5c8ea0,
        shininess: 50.00,
        waveHeight: 10.00,
        zoom: 0.65
      })
      setTimeout(() => {
        const main = document.querySelector('main')
        main.style.opacity = 1;
        main.style.filter = 'blur(0px)';
      }, 500);
    });

    function myFunction() {
      var copyText = document.getElementById('button-gmail');
      const content = copyText.textContent.trim();
      navigator.clipboard.writeText(content);
      var tooltip = document.getElementById("myTooltip");
      tooltip.innerHTML = "Copied: " + copyText.textContent;
      tooltip.className = "tooltiptext tooltiptext2";

      setTimeout(() => {
        const main = document.querySelector('span');
        main.style.opacity = 0;
        main.style.filter = 'blur(0px)';
      }, 1500);

      const main = document.querySelector('span');
      main.style.opacity = 1;
    }

    function outFunc() {
      var tooltip = document.getElementById("myTooltip");
      tooltip.innerHTML = "";
      tooltip.className = "tooltiptext";
    }

    function hover(id) {
      const element = document.getElementById("img-" + id);
      element.setAttribute('src', `./images/${id}-logo-colored.gif`);
      
      // check if cursor pointer is true
      // if is true, do note reset gif
    }

    function unhover(id) {
      const element = document.getElementById("img-" + id);

      const liElement = document.getElementById(id);

      const li = liElement; //index 1s change once
      const liClassName = li.className;
      console.log(liClassName);

      if (liClassName === `${color[index]}`) {
        element.setAttribute('src', `./images/${id}-logo-colored.gif`);
      } else if (liClassName === "color-fffa") {
        element.setAttribute('src', `./images/${id}-logo.gif`);
      }

      let isCalled = true;

    }

    let index = -1;
    let prevIndex = -1;

    function incrementLoop() {
      if (index >= 4) {
        index = 0;
      } else {
        index += 1;
      }

      if (index === 0) {
        prevIndex = 4;
      } else {
        prevIndex = index - 1;
      }
    }

    function changeColor() {
      setInterval(incrementLoop, 2000);
      nIntervId = setInterval(flashButton, 2000);
      colorList();
    }

    const buttonList = document.querySelectorAll('li');
    const color = [];

    function colorList() {
      buttonList.forEach(button => {
        color.push(button.className);
      });

      buttonList.forEach(button => {
        button.className = 'color-fffa';
      });
      return color;
    }

    function flashButton() {
      // 0, 1, 2, 3, 4, 0, 1, 2....

      const currentElement = buttonList[index];
      const prevElement = buttonList[prevIndex];

      currentElement.className = currentElement.className === "color-fffa" ? `${color[index]}` : "color-fffa";
      console.log(currentElement.className);

      const currentA = currentElement.childNodes[1]; // gmail is undefind
      const prevA = prevElement.childNodes[1];

      if (currentA.className !== 'tooltip') {
        currentA.className = currentA.className === "link" ? "link-white" : "link";

        if (currentElement.className === `${color[index]}`) {
          const currentImg = document.getElementById("img-" + buttonList[index].id);
          currentImg.setAttribute('src', `./images/${buttonList[index].id}-logo-colored.gif`);

          // if cursor is on li , do not reset 
          console.log(buttonList[index].getAttribute('onmouseover'));
          const onMouseOver = buttonList[index].getAttribute('onmouseover');

          if (onMouseOver == true) {

          } else {
            const prevImg = document.getElementById("img-" + buttonList[prevIndex].id);
            prevImg.setAttribute('src', `./images/${buttonList[prevIndex].id}-logo.gif`);
          }
        }
        // else {
        //   const currentImg = document.getElementById("img-" + buttonList[index].id);
        //   currentImg.setAttribute('src', `./images/${buttonList[index].id}-logo.gif`);

        //   // const prevImg = document.getElementById("img-" + buttonList[prevIndex].id);
        //   // prevImg.setAttribute('src', `./images/${buttonList[prevIndex].id}-logo-colored.gif`);
        // }

      } else {
        const button = document.getElementById('button-gmail');
        button.className = button.className === "button" ? "button-white" : "button";

        if (currentElement.className === `${color[index]}`) {
          const currentImg = document.getElementById("img-" + buttonList[index].id);
          currentImg.setAttribute('src', `./images/${buttonList[index].id}-logo-colored.gif`);
        } else {
          const currentImg = document.getElementById("img-" + buttonList[index].id);
          currentImg.setAttribute('src', `./images/${buttonList[index].id}-logo.gif`);
        }
      }

      if (currentElement.className === `${color[index]}`) {
        prevElement.className = "color-fffa";
        prevA.className = "link";

      }
    }

    function stopTextColor() {
      clearInterval(nIntervId);
    }
  </script>
</body>

</html>